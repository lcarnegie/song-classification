# Song Cluster

## Overview

**Song Cluster** is the companion repository to my undergraduate research paper, _Do Machines Think Equally About Music?_. 

This project investigates how well a Support Vector Machine (SVM) classifier trained on human-made music can classify songs generated by a machine learning model, Meta’s MuseGen (via the MusicGPT interface).

The repository is organized to allow complete and exact reproduction of the study, including:

- Downloading and cleaning raw music data,
- Training several machine learning classifiers (SVM, KNN, Random Forest, XGBoost) on audio feature datasets,
- Prompting a small MuseGen model to generate genre-specific music clips,
- Extracting features from machine-generated music,
- Testing the ability of a classifier to predict the genre of AI-generated songs,
- Producing the final paper.

The study highlights the limitations of current machine learning approaches to both music generation and classification, suggesting directions for future research in music information retrieval and generative AI.

---

## Repository Structure

```
├── data/
│   ├── raw_data/           # Compressed raw song data from FMA and MuseGen-generated audio (.wav files)
│   ├── analysis_data/      # Cleaned and processed datasets ready for modeling
├── models.zip              # Pretrained clustering models (unzip before use)
├── other/                  # Music generation prompts and sketches
├── paper/
│   ├── paper.qmd           # Quarto source file for the paper
│   ├── references.bib      # Reference file (BibTeX)
│   ├── paper.pdf           # Final PDF of the paper
├── scripts/                # Python scripts for data processing, model training, feature extraction
├── README.md               # You're here
```

---

## Requirements

Install the following:

- **Python 3.9+**
- Modules:
  - `pandas`
  - `numpy`
  - `scikit-learn`
  - `xgboost`
  - `matplotlib`
  - `seaborn`
  - `librosa`
  - `zipfile`
  - `os`
  - `glob`
  - `pathlib`
  - `quarto` (optional, for paper compilation)

You can install the needed Python packages with:

```bash
pip install -r requirements.txt
```

_(Note: You may need to manually install `librosa` if not included.)_

---

## Reproduction Steps

Follow these steps to fully reproduce the paper’s results:

1. **Clone the Repository**  
   ```bash
   git clone https://github.com/lcarnegie/song-classification.git
   cd song-classification
   ```

2. **Prepare the Data**  
   - Unzip the `models.zip` file to access pretrained models.
   - The `data/raw_data/` folder contains compressed audio and extracted feature files.

3. **Run Data Processing Scripts**  
   In `scripts/`, run:
   ```bash
   python clean_fma_data.py
   python generate_music_prompts.py
   python extract_features.py
   ```

4. **Train Classifiers** (Optional)  
   If you want to retrain models rather than using the provided ones:
   ```bash
   python train_models.py
   ```

5. **Classify Generated Music**  
   After generating feature sets for the machine-generated songs:
   ```bash
   python classify_generated_music.py
   ```

6. **Build the Paper (Optional)**  
   If you'd like to regenerate the paper PDF:
   ```bash
   quarto render paper/paper.qmd
   ```

---

## Main Findings

- The SVM model trained on human music failed to correctly classify any machine-generated song into the correct genre.
- Results suggest a gap between machine-generated and human-composed music in terms of recognizable genre-specific patterns.
- Larger models or more sophisticated prompts may improve future genre fidelity in music generation.

See the full discussion and analysis in the final paper: [`paper/paper.pdf`](paper/paper.pdf).

---

## Statement on LLM Usage

Aspects of the code and text were written with the assistance of GitHub Copilot and ChatGPT to improve efficiency.  
All original ideas, experiment designs, and analyses are my own.

---

## Citation

If you use this work, please cite:

> Carnegie, Luca. _Do Machines Think Equally About Music?_ April 2025.  
> [GitHub Repo](https://github.com/lcarnegie/song-classification)

![Built with Quarto](https://img.shields.io/badge/Built%20With-Quarto-8a4fff?logo=quarto)
![Python](https://img.shields.io/badge/Python-3.9%2B-blue?logo=python)
